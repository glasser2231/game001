<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>משחק עם כניסת גוגל</title>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <meta name="google-signin-client_id" content="YOUR_GOOGLE_CLIENT_ID">
    <script>
        function onSignIn(googleUser) {
            document.getElementById("game-container").style.display = "block";
            document.getElementById("login-container").style.display = "none";
            startGame();
        }
        
        function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
                document.getElementById("game-container").style.display = "none";
                document.getElementById("login-container").style.display = "block";
            });
        }
        
        function goToStats() {
            var auth2 = gapi.auth2.getAuthInstance();
            var user = auth2.currentUser.get();
            var profile = user.getBasicProfile();
            
            window.location.href = "stats.html?name=" + encodeURIComponent(profile.getName()) + "&email=" + encodeURIComponent(profile.getEmail());
        }
        
        function initAuth() {
            gapi.load('auth2', function() {
                gapi.auth2.init().then(function(auth2) {
                    if (auth2.isSignedIn.get()) {
                        onSignIn(auth2.currentUser.get());
                    }
                });
            });
        }
    </script>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
        canvas { background: lightgray; display: block; margin: auto; border: 2px solid black; }
    </style>
</head>
<body onload="initAuth()">
    <div id="login-container">
        <div class="g-signin2" data-onsuccess="onSignIn"></div>
    </div>
    
    <div id="game-container" style="display: none;">
        <h1>ברוך הבא למשחק!</h1>
        <button onclick="goToStats()">מידע על המשתמש</button>
        <button onclick="signOut()">התנתקות</button>
        
        <canvas id="gameCanvas"></canvas>
        <script>
            var canvas = document.getElementById("gameCanvas");
            var ctx = canvas.getContext("2d");
            canvas.width = 800;
            canvas.height = 600;
            
            var player = {
                x: 50,
                y: 50,
                width: 50,
                height: 50,
                color: "blue",
                speed: 5
            };
            
            function drawPlayer() {
                ctx.fillStyle = player.color;
                ctx.fillRect(player.x, player.y, player.width, player.height);
            }
            
            function update() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawPlayer();
                requestAnimationFrame(update);
            }
            
            document.addEventListener("keydown", function(event) {
                if (event.key === "ArrowRight" && player.x + player.width < canvas.width) player.x += player.speed;
                if (event.key === "ArrowLeft" && player.x > 0) player.x -= player.speed;
                if (event.key === "ArrowUp" && player.y > 0) player.y -= player.speed;
                if (event.key === "ArrowDown" && player.y + player.height < canvas.height) player.y += player.speed;
            });
            
            function startGame() {
                update();
            }
        </script>
    </div>
</body>
</html>
